[{"id":"2f607b868ca6b62f","type":"function","z":"273ab2b416b8e867","name":"Revert to hour prices","func":"const num_quarters = 4\n\nlet prices = [];\nfor (let index = 0; index < msg.payload.attributes.raw_today.length; index++) {    \n    prices.push(msg.payload.attributes.raw_today[index]);     \n}\n\nfor(let index = 0; index < msg.payload.attributes.raw_tomorrow.length; index++) {\n    prices.push(msg.payload.attributes.raw_tomorrow[index]);\n}\n\nvar averages = [];\nfor(let index = 0; index <= prices.length-num_quarters; index+=4) { \n    var hourly_index = index/4;   \n    averages[hourly_index] = {value: 0, start: prices[index].start}\n    averages[hourly_index].value = 0;\n    averages[hourly_index].start = prices[index].start;\n    \n    for(let j = 0; j < num_quarters; j++) {\n        averages[hourly_index].value += prices[index+j].value;\n    }\n    averages[hourly_index].value = averages[hourly_index].value / num_quarters;\n}\nmsg.payload.attributes.raw_today = averages.slice(0, 24);\nmsg.payload.attributes.raw_tomorrow = averages.slice(24);\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":280,"y":220,"wires":[["2fbd966a3f0d94fb"]]}]
